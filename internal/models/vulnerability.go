package models

import "github.com/gleicon/sonnel/internal/evidence"

// OWASPCategory represents the OWASP Top 10 and OAT categories
type OWASPCategory string

const (
	// OWASP Top 10 Categories
	CategoryBrokenAccessControl      OWASPCategory = "A1: Broken Access Control"
	CategoryCryptographicFailures    OWASPCategory = "A2: Cryptographic Failures"
	CategoryInjection                OWASPCategory = "A3: Injection"
	CategoryInsecureDesign           OWASPCategory = "A4: Insecure Design"
	CategorySecurityMisconfiguration OWASPCategory = "A5: Security Misconfiguration"
	CategoryVulnerableComponents     OWASPCategory = "A6: Vulnerable and Outdated Components"
	CategoryIntegrityFailures        OWASPCategory = "A7: Identification and Authentication Failures"
	CategoryLoggingFailures          OWASPCategory = "A8: Software and Data Integrity Failures"
	CategorySSRF                     OWASPCategory = "A9: Security Logging and Monitoring Failures"
	CategoryServerSideRequestForgery OWASPCategory = "A10: Server-Side Request Forgery"

	// OWASP Automated Threats (OAT) Categories
	CategoryCarding               OWASPCategory = "OAT-001: Carding"
	CategoryTokenCracking         OWASPCategory = "OAT-002: Token Cracking"
	CategoryAdFraud               OWASPCategory = "OAT-003: Ad Fraud"
	CategoryFingerprinting        OWASPCategory = "OAT-004: Fingerprinting"
	CategoryScalping              OWASPCategory = "OAT-005: Scalping"
	CategoryExpediting            OWASPCategory = "OAT-006: Expediting"
	CategoryCredentialCracking    OWASPCategory = "OAT-007: Credential Cracking"
	CategoryCredentialStuffing    OWASPCategory = "OAT-008: Credential Stuffing"
	CategoryCAPTCHADefeat         OWASPCategory = "OAT-009: CAPTCHA Defeat"
	CategoryCardCracking          OWASPCategory = "OAT-010: Card Cracking"
	CategoryScraping              OWASPCategory = "OAT-011: Scraping"
	CategoryCashingOut            OWASPCategory = "OAT-012: Cashing Out"
	CategorySniping               OWASPCategory = "OAT-013: Sniping"
	CategoryVulnerabilityScanning OWASPCategory = "OAT-014: Vulnerability Scanning"
	CategoryDenialOfService       OWASPCategory = "OAT-015: Denial of Service"
	CategorySkewing               OWASPCategory = "OAT-016: Skewing"
	CategorySpamming              OWASPCategory = "OAT-017: Spamming"
	CategoryFootprinting          OWASPCategory = "OAT-018: Footprinting"
	CategoryAccountCreation       OWASPCategory = "OAT-019: Account Creation"
	CategoryAccountAggregation    OWASPCategory = "OAT-020: Account Aggregation"
	CategoryDenialOfInventory     OWASPCategory = "OAT-021: Denial of Inventory"

	// LLM Security Categories
	CategoryLLMPromptInjection     OWASPCategory = "LLM1: Prompt Injection"
	CategoryLLMDataLeakage         OWASPCategory = "LLM2: Data Leakage"
	CategoryLLMContextManipulation OWASPCategory = "LLM3: Context Manipulation"
)

// SeverityLevel represents the severity of a vulnerability
type SeverityLevel string

const (
	Critical SeverityLevel = "Critical"
	High     SeverityLevel = "High"
	Medium   SeverityLevel = "Medium"
	Low      SeverityLevel = "Low"
	Info     SeverityLevel = "Info"
)

// Vulnerability represents a security vulnerability found during scanning
type Vulnerability struct {
	Title       string
	Description string
	Severity    SeverityLevel
	Category    OWASPCategory
	Details     map[string]string
	URL         string
	Evidence    *evidence.Evidence
	Remediation string
}

// ScanResult represents the overall result of a security scan
type ScanResult struct {
	Target          string
	Timestamp       string
	Vulnerabilities []Vulnerability
	Summary         map[OWASPCategory]int
	SeverityCount   map[SeverityLevel]int
}
